<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/app_hs.css">
    <link rel="stylesheet" href="css/fridge_contents.css">
    <title>Fridge contents</title>
</head>
<body>
    <nav>
        <nav id='menu'>
            <input type='checkbox' id='responsive-menu' onclick='updatemenu()'>
            <ul>
                <li>
                    <img class="logo" src="img/logo.png" alt="">
                </li>
                <li class="nav-link">
                    <a class="nav-link"  href='app_homescreen.html'>Home</a>
                </li>
                <li class="nav-link">
                    <a class="nav-link" href='fridge_contents.html'>Fridge contents</a>
                </li>
                <li class="nav-link">
                    <a class="nav-link" href='sharing_is_caring.html'>Sharing is caring</a>
                </li>
                <li class="nav-link">
                    <a class="nav-link" href='shopping_list.html'>Shopping list</a>
                </li>
                <li class="nav-link">
                    <a class="nav-link" href='recipes.html'>Recipes</a>
                </li>
            </ul>
          </nav>
          <!-- Hier komt site specefieke informatie te staan -->
          <div>
            <video id="preview"></video>
            <button id="snap">Snap Photo</button>
          </div>
          <script>
            fetch("json/products.json")
                .then(response => response.json())
                .then(products => {
                    // Create a new div element with a class of "product-cards-container"
                    const container = document.createElement("div");
                    container.classList.add("product-cards-container");

                    // Iterate over the array of products
                    for (const product of products) {
                    // Extract the name, description, URL, and href of the product
                    const { name, experation_date, url, href , alert_threshold} = product;

                    // Create a new div element for the product card
                    const div = document.createElement("div");
                    div.classList.add("product-card");

                    // Add the name, description, and image to the product card
                    div.innerHTML = `
                        <div class="textbox"><h2 id="top">${name}</h2><div>
                        <div class="textbox"><a href="${href}"><img src="${url}" alt="${name}"></a><div>
                        <div class="textbox"><p id="bottom">${experation_date} ${alert_threshold} days left</p><div>
                        
                    `;

                    // Append the product card to the container element
                    container.appendChild(div);
                    }
                    // Append the container element to the body of the document
                    document.body.appendChild(container);
                });
          </script>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>
          <script >
        // access the camera
        navigator.mediaDevices.getUserMedia({ video: true })
        .then(function(stream) {
            var video = document.getElementById('preview');
            video.srcObject = stream;
            video.play();
        });
        
        // when the snap button is clicked
        document.getElementById('snap').addEventListener('click', function() {
        var canvas = document.createElement('canvas');
        var video = document.getElementById('preview');
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        canvas.getContext('2d').drawImage(video, 0, 0);
        var img = canvas.toDataURL('image/png');
        
        // decode the barcode
        Quagga.decodeSingle({
            decoder: {
                readers: ["code_128_reader","ean_reader","ean_8_reader","code_39_reader","code_39_vin_reader","codabar_reader","upc_reader","upc_e_reader","i2of5_reader"]
            },
            locate: true,
            src: img
        }, function(result) {
            if (result.codeResult) {
                console.log(result.codeResult.code);
            } else {
                console.log("No barcode found.");
            }
        });
        });

          </script>
        <script src="javascript/activebutton.js">

        </script>
    </nav>
</body>
</html>